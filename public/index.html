<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3940256099942544"
    crossorigin="anonymous"></script>

    <!-- Favicon -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">

<!-- √çcones PWA -->
<link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192.png">

<!-- Manifest -->

<link rel="manifest" href="/manifest.json">

<meta name="theme-color" content="#6b46c1">

    <title>Allora - Duelo de Ideias Sem Paix√£o</title>
    <style>
        * { box-sizing: border-box; }

        body { 
            margin: 0; padding: 10px; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: #fdfcfd; text-align: center; color: white; overflow-x: hidden;
        }

        #pageLoader {
            position: fixed; inset: 0; background: #9d5fe9;
            z-index: 9999; display: flex; align-items: center; justify-content: center;
        }

        .loader-circle {
            width: 60px; height: 60px; border: 6px solid rgba(255,255,255,0.3);
            border-top: 6px solid #fff; border-radius: 50%; animation: spin 1s linear infinite;
        }

        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .menu-caixa { 
            background: rgba(120, 83, 152, 0.9); backdrop-filter: blur(6px);
            color: #333; padding: 15px; border-radius: 20px; 
            max-width: 360px; width: 100%; margin: 15px auto; box-shadow: 0 10px 25px rgba(0,0,0,0.4); 
        }

        #erroTema {
            color: #a6ff00;
            font-size: 12px;
            font-weight: bold;
            display: none;
            margin-bottom: 5px;
        }

        .img-versus {
            display: block;
            margin: 10px auto;
            width: 100vw;
            max-width: 280px;
            aspect-ratio: 1 / 1;
            object-fit: contain;
        }

        .img-versus-central {
            width: 40px; height: 40px; align-self: center; object-fit: contain; margin: 0 5px;
        }

        .seletor-tema {
            width: 100%; padding: 12px; margin: 10px 0;
            border-radius: 12px; border: 2px solid #9d5fe9;
            background: white; font-weight: bold; color: #4a148c;
        }

        .btn-aurora { 
            width: 100%; padding: 12px; margin: 6px 0; border: none; 
            border-radius: 16px; font-weight: bold; cursor: pointer; 
            color: white; font-size: 16px; transition: transform 0.2s ease;
        }

        .btn-aurora:active { transform: scale(0.97); }
        .roxo { background: #98df4c; } /* Cor para o bot√£o inicial */
        .rosa { background: #f49bb9; }
        .azul-info { background: #4caedf; cursor: default; } /* Cor Azul Informativa */
        .verde { background: #5ae9e9; } /* Nova cor Verde claro */

        .cards-area { 
            display: none; justify-content: center; gap: 10px; 
            margin: 12px auto 40px; padding: 15px 10px; background: rgba(255,255,255,0.2);
            border-radius: 20px; flex-wrap: nowrap;
            align-items: center;
            max-width: 420px;
        }

        .card-container { width: 185px; height: 220px;} 

        .card { 
            width: 100%; height: 220px; background: #1a1a1a; 
            border-radius: 12px; border: 3px solid #fff; overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5); position: relative;
        }

        .card img { width: 100%; height: 95%; object-fit: cover; object-position: top; }

        .label-card { 
            position: absolute; top: 0; width: 100%; background: rgba(0,0,0,0.7);
            color: #fff; font-size: 11.5px; padding: 4px 2px; font-weight: bold;
            white-space: nowrap;
        }

        .nome-filosofo {
            margin-top: 8px; background: #addf70; color: white;
            font-size: 11px; padding: 6px; border-radius: 8px;
            min-height: 35px; display: flex; align-items: center; justify-content: center;
            line-height: 1.1; font-weight: bold;
        }

        #status { 
            margin: 10px auto; 
            font-size: 14px; 
            color: #333; 
            font-weight: bold; 
            padding: 0 15px;
            max-width: 420px;
            text-align: justify;
            display: block;
        }

        #aiBox { 
            display: none; 
            background: white; 
            color: #333; 
            padding: 18px; 
            border-radius: 15px; 
            text-align: left; 
            margin: 15px auto; 
            max-width: 420px;
            font-size: 15px; 
            line-height: 1.6; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            position: relative;
        }

        .btn-zap-redondo { position: absolute; top: 10px; right: 10px; width: 40px; cursor: pointer; }

        #btnSorteio {
            max-width: 420px;
            margin: 6px auto;
            display: block;
        }

    </style>
</head>

<body onload="document.getElementById('pageLoader').style.display='none';">

    <div id="pageLoader"><div class="loader-circle"></div></div>

    <div id="menuInicial" class="menu-caixa">
        <div class="banner-abertura">
            <img src="/imagens_app/img_versus.png" class="img-versus" alt="Versus">
        </div>
        <p style="color:#ede4e4; font-weight: bold; margin: 5px 0;">Digite ou selecione um tema:</p>
        <div id="erroTema">‚ö†Ô∏è Por favor, escolha um tema antes de iniciar!</div>
        <input list="temasFilosoficos" id="seletorTema" class="seletor-tema" placeholder="Escreva seu pr√≥prio tema do momento...">
        <datalist id="temasFilosoficos"></datalist>
        <button onclick="iniciarDuelo()" class="btn-aurora roxo">‚öîÔ∏è Bora Iniciar Duelo</button>
    </div>
    
    <div id="jogoArea" style="display:none;">
        <div class="cards-area" id="containerFilosofos">
            <div class="card-container">
                <div class="card">
                    <img id="fotoLunar" src="/imagens_app/lunares.png">
                    <div class="label-card">Lunares - desconfiam dela</div>
                </div>
                <div id="nomeLunar" class="nome-filosofo">Prontos para duelar...</div>
            </div>
            
            <img src="/imagens_app/verusX.png" class="img-versus-central">
            
            <div class="card-container">
                <div class="card">
                    <img id="fotoSolar" src="/imagens_app/solares.png">
                    <div class="label-card">Solares - prometem raz√£o</div>
                </div>
                <div id="nomeSolar" class="nome-filosofo">Prontos para duelar...</div>
            </div>
        </div>
        
        <div id="areaBotaoAcao">
            <button id="btnSorteio" class="btn-aurora rosa" onclick="sortear()">üÉèJogue com Influencers da Alta Narrativa</button>
        </div>
        
        <div id="status">Prepara-se... Come√ßa a grande batalha do pensamento humano sem aquele velho vi√©s passional t√£o presente nas redes hoje em dia. Chegou a hora de exorcizar seus fantasmas narrativos que as redes lhe impuseram ‚Äî e que voc√™ ainda assume como seus. Nunca foram. Jogue sem d√≥ e mate o que est√° te matando: a mentira intencional institucionalizada pelas Big Techs por mais poder pol√≠tico, econ√¥mico e religioso. Querem a domina√ß√£o total!</div>
        
        <div id="aiBox">
            <img src="/imagens_app/zap.png" class="btn-zap-redondo" onclick="shareOnWhatsApp()">
            <div id="conteudoIA"></div>
        </div>
    </div>

    <script>
        const filosofosLunares = ["Albert-Camus.png", "Adorno.png", "Benjamin.png", "Byung-Chul-Han.png", "Carl-Jung.png", "Emil-Cioran.png", "Fernando-Pessoa.png", "Foucault.png", "Freud.png", "Georges-Bataille.png", "Gilles-Deleuze.png", "Guy-Debord.png", "Hannah-Arendt.png", "Heidegger.png", "Heraclito.png", "Huizinga.png", "Hume.png", "Jacques-Derrida.png", "John-Gray.png", "Kierkegaard.png", "Lucrecio.png", "Ludwig-Wittgenstein.png", "Nietzsche.png", "Pascal.png", "Peter-Zapfee.png", "Santo-Agostinho.png", "Sartre.png", "Schopenhauer.png", "Unamuno.png", "Vil√©m-Flusser.png"];
        const filosofosSolares = ["Aristoteles.png", "Bernard Suits.png", "Bostrom.png", "Buno Latour.png", "Cicero.png", "Comte.png", "Descartes.png", "Durkheim.png", "Francis Bacon.png", "Habermas.png", "Harari.png", "Hegel.png", "John Nash.png", "Kant.png", "Leibniz.png", "Locke.png", "Marx.png", "Mill.png", "Montesquieu.png", "Pitagoras.png", "Platao.png", "Roger Caillois.png", "Rousseau.png", "Sloterdijk.png", "Socrates.png", "Spinoza.png", "Steve Bannon.png", "Thomas Schelling.png", "Tomas de Aquino.png", "Weber.png"];

        let lunarSorteado = "";
        let solarSorteado = "";

        fetch("https://raw.githubusercontent.com/seabhra/allora-filosofal-api/main/temas_filosoficos.json")
          .then(res => res.json())
          .then(data => {
            const datalist = document.getElementById("temasFilosoficos");
            datalist.innerHTML = "";
            data.temas.forEach(tema => {
              const option = document.createElement("option");
              option.value = tema;
              datalist.appendChild(option);
            });
          });

        function iniciarDuelo() {
            const temaInput = document.getElementById('seletorTema').value;
            const erroEl = document.getElementById('erroTema');
            if (temaInput.trim() === "") {
                erroEl.style.display = 'block';
                return;
            }
            erroEl.style.display = 'none';
            document.getElementById('menuInicial').style.display = 'none';
            document.getElementById('jogoArea').style.display = 'block';
            document.getElementById('containerFilosofos').style.display = 'flex';
        }

        function sortear() {
            document.getElementById('status').innerText = "No Conclave das Altas Narrativas, 60 fil√≥sofos entre lunares e solares disputam mais de 2.500 anos de hist√≥ria intelectual. Agora a luta √© contra o julgo das paix√µes narrativas induzidas nas redes sociais com pouco controle civilizat√≥rio. Na entrada da arena de combate, a sagaz Allora est√° armada at√© os dentes ‚Äî uma IA bastante treinada para barrar que discursos passionais das redes sabotem qualquer conhecimento informado testado ao longo da hist√≥ria.";

            const areaBotao = document.getElementById('areaBotaoAcao');
            // MUDAN√áA: Bot√£o azul durante o processamento
            areaBotao.innerHTML = `<button class="btn-aurora azul-info">Agora a bola est√° com pensadores hist√≥ricos...</button>`;
            
            let ciclos = 0;
            const intervalo = setInterval(() => {
                const tempL = filosofosLunares[Math.floor(Math.random() * filosofosLunares.length)];
                const tempS = filosofosSolares[Math.floor(Math.random() * filosofosSolares.length)];
                
                document.getElementById('fotoLunar').src = "/imagens_lunares_png/" + tempL;
                document.getElementById('fotoSolar').src = "/imagens_solares_png/" + tempS;
                
                document.getElementById('nomeLunar').innerText = tempL.replace('.png', '').replace(/-/g, ' ');
                document.getElementById('nomeSolar').innerText = tempS.replace('.png', '').replace(/-/g, ' ');

                if (ciclos++ > 100) {
                    clearInterval(intervalo);
                    lunarSorteado = tempL.replace('.png', '');
                    solarSorteado = tempS.replace('.png', '');
                    gerarConfrontoIA();
                }
            }, 90);
        }

        // CHAMADA DA API VERCEL

async function gerarConfrontoIA() {
  const statusEl = document.getElementById('status');
  const tema = document.getElementById('seletorTema').value || "Exist√™ncia";

  statusEl.innerText = "Aguarde... Os grandes fil√≥sofos da hist√≥ria duelam neste momento...";

  try {
    const res = await fetch('https://api-allora-filosofal.vercel.app/api/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        pergunta: `Promova um duelo de ideias sem vi√©s passional entre ${lunarSorteado} e ${solarSorteado} sobre o tema: ${tema}.`
      })
    });

    if (!res.ok) {
      throw new Error(`API respondeu ${res.status}`);
    }

    const data = await res.json();

    if (!data.resposta) {
      throw new Error("Resposta inv√°lida da API");
    }

    document.getElementById('conteudoIA').innerHTML = `
      <h3 style="color:#4a148c; text-align:center">
        ‚öîÔ∏è ${lunarSorteado} vs ${solarSorteado}
      </h3>
      <p style="font-size:13px; color:#666">
        <strong>Tema:</strong> ${tema}
      </p>
      <hr>
      <p>${data.resposta.replace(/\n/g, '<br>')}</p>
    `;

    document.getElementById('aiBox').style.display = 'block';
    statusEl.innerText = "O duelo foi conclu√≠do.";

    document.getElementById('areaBotaoAcao').innerHTML =
      `<button onclick="location.reload()" class="btn-aurora verde">
        ‚ôªÔ∏è Novo Duelo entre Pensadores
      </button>`;

  } catch (e) {
    console.error(e);
    statusEl.innerText = "Erro ao acessar a IA: " + e.message;

    document.getElementById('areaBotaoAcao').innerHTML =
      `<button onclick="location.reload()" class="btn-aurora verde">
        ‚ôªÔ∏è Novo Duelo entre Pensadores
      </button>`;
  }
}

 // CHAMADA DO WHATSAPPL

        function shareOnWhatsApp() {
            const texto = document.querySelector('#conteudoIA').innerText;
            window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent("üî• Veja este duelo filos√≥fico:\n\n" + texto)}`, '_blank');
        }

        
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js')
        .then(registration => {
          console.log('ServiceWorker registration successful');
        })
        .catch(err => {
          console.log('ServiceWorker registration failed: ', err);
        });
    });
}

    </script>
</body>

</html>

